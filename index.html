<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  
  <!-- SEO Meta Tags -->
  <title>Mandelscope - Interactive Mandelbrot & Julia Set Explorer | Fractal Visualisation</title>
  <meta name="description" content="Explore the infinite beauty of the Mandelbrot set and Julia sets with Mandelscope. Interactive fractal visualisation with smooth zooming, preset locations, and real-time GPU rendering. Perfect for mathematics students and fractal enthusiasts." />
  <meta name="keywords" content="Mandelbrot set, Julia set, fractal explorer, complex numbers, mathematics visualisation, interactive fractals, WebGL fractals, chaos theory, fractal geometry, mathematical visualisation" />
  <meta name="author" content="Neil Kendall" />
  <meta name="robots" content="index, follow" />
  <meta name="language" content="English" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.korovatron.co.uk/mandelscope/" />
  <meta property="og:title" content="Mandelscope - Interactive Mandelbrot & Julia Set Explorer" />
  <meta property="og:description" content="Explore the infinite beauty of the Mandelbrot set and Julia sets with smooth zooming, preset famous locations, and real-time GPU rendering." />
  <meta property="og:image" content="https://www.korovatron.co.uk/mandelscope/screenshot.png" />
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content="https://www.korovatron.co.uk/mandelscope/" />
  <meta property="twitter:title" content="Mandelscope - Interactive Mandelbrot & Julia Set Explorer" />
  <meta property="twitter:description" content="Explore the infinite beauty of the Mandelbrot set and Julia sets with smooth zooming, preset famous locations, and real-time GPU rendering." />
  <meta property="twitter:image" content="https://www.korovatron.co.uk/mandelscope/screenshot.png" />
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://www.korovatron.co.uk/mandelscope/" />
  
  <!-- PWA Meta Tags -->
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Mandelscope" />
  <meta name="theme-color" content="#100C5C" />
  
  <!-- Icons and Manifest -->
  <link rel="icon" type="image/png" href="iconTrans.png">
  <link rel="apple-touch-icon" href="iconSolid.png">
  <link rel="manifest" href="manifest.json">
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Mandelscope",
    "description": "Interactive Mandelbrot and Julia set explorer with real-time GPU rendering, smooth zooming, and preset famous fractal locations",
    "url": "https://www.korovatron.co.uk/mandelscope/",
    "applicationCategory": "EducationalApplication",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "GBP"
    },
    "author": {
      "@type": "Person",
      "name": "Neil Kendall"
    },
    "keywords": "Mandelbrot set, Julia set, fractals, mathematics, complex numbers, visualisation",
    "screenshot": "https://www.korovatron.co.uk/mandelscope/screenshot.png",
    "softwareVersion": "1.0",
    "datePublished": "2025-10-31"
  }
  </script>
  
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Title Screen -->
  <div id="title-screen">
    <div class="title-content">
      <canvas id="title-logo-canvas" class="title-logo"></canvas>
      <h1>Mandelscope</h1>
      <p class="subtitle">Explore Mandelbrot and Julia sets<br>Quite complex, actually</p>
      <p class="equation">z<sub>n+1</sub> = z<sub>n</sub><sup>2</sup> + c</p>
      
      <div class="title-buttons">
        <button id="start-btn" class="start-button">Start Exploring</button>
        <a href="algorithm.html" class="start-button" style="display: inline-block; text-decoration: none;">Algorithm Guide</a>
      </div>
      <p class="hint" style="margin-top: 20px;">¬© 2025 Neil Kendall</p>
      <p class="hint">More @ <a href="https://www.korovatron.co.uk/" target="_blank" rel="noopener noreferrer">www.korovatron.co.uk</a></p>
    </div>
  </div>

  <div id="app">
    <header>
      <h1>
        Mandelscope
      </h1>
      <button id="menu-toggle" class="menu-toggle" aria-label="Settings">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </header>

    <!-- Settings Panel -->
    <div id="settings-panel" class="settings-panel hidden">
      <div class="settings-content">
        <h3>Settings</h3>
        <div class="setting-group">
          <label>
            <input id="auto-iter" type="checkbox" checked>
            Auto iterations
          </label>
        </div>
        <div class="setting-group">
          <label>Max iterations: <span id="iterVal">500</span></label>
          <input id="iter" type="range" min="50" max="20000" value="500">
        </div>
        <div class="setting-group" id="coord-display-setting">
          <label style="display: block; margin-bottom: 8px; font-weight: bold;">Current Coordinates:</label>
          <div id="coord-info-panel" style="font-family: monospace; font-size: 12px; line-height: 1.6; color: var(--text-secondary, #B0C4DE); background: rgba(0,0,0,0.2); padding: 8px; border-radius: 4px;">
            <span id="coord-value-panel">Move mouse over canvas</span>
          </div>
        </div>
        <div class="setting-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
          <button id="reset" class="reset-btn">Reset View</button>
          <button id="return-to-title" class="reset-btn">Return to Title</button>
        </div>
        <div class="setting-group" style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px; margin-top: 10px;">
          <label style="display: block; margin-bottom: 8px; font-weight: bold;">Mandelbrot Locations:</label>
          <select id="preset-locations" style="width: 100%; padding: 8px; background: #100C5C; color: var(--text-primary, #E8F4FD); border: 1px solid var(--border-color, #555); border-radius: 4px; font-size: 14px; margin-bottom: 8px;">
            <option value="">Select a location...</option>
            <option value="seahorse">Seahorse Valley</option>
            <option value="elephant">Elephant Valley</option>
            <option value="triple-spiral">Triple Spiral Valley</option>
            <option value="dendrite">Dendrite</option>
            <option value="mini-mandelbrot">Mini Mandelbrot</option>
            <option value="misiurewicz">Misiurewicz Point</option>
            <option value="scepter">Scepter Valley</option>
            <option value="satellite">Satellite</option>
            <option value="deep-river">Deep River (e-23)</option>
          </select>
          <button id="manage-locations-btn" style="width: 100%; padding: 8px; background: rgba(255,255,255,0.1); color: var(--text-primary, #E8F4FD); border: 1px solid var(--border-color, #555); border-radius: 4px; font-size: 14px; cursor: pointer;">Manage Locations...</button>
        </div>
        <div class="setting-group" style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px; margin-top: 10px;">
          <label style="display: block; margin-bottom: 8px; font-weight: bold;">Julia Set Collections:</label>
          <select id="julia-locations" style="width: 100%; padding: 8px; background: #100C5C; color: var(--text-primary, #E8F4FD); border: 1px solid var(--border-color, #555); border-radius: 4px; font-size: 14px; margin-bottom: 8px;">
            <option value="">Select a Julia set...</option>
          </select>
          <button id="manage-julia-btn" style="width: 100%; padding: 8px; background: rgba(255,255,255,0.1); color: var(--text-primary, #E8F4FD); border: 1px solid var(--border-color, #555); border-radius: 4px; font-size: 14px; cursor: pointer;">Manage Julia Sets...</button>
        </div>
        <div class="setting-group" style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px; margin-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
          <button id="show-implementation-btn" class="reset-btn" style="font-size: 0.8rem; padding: 6px 4px;">Deep Zoom</button>
          <button id="show-controls-btn" class="reset-btn" style="font-size: 0.8rem; padding: 6px 4px;">Controls</button>
        </div>
      </div>
    </div>

    <!-- Controls Overlay (hidden by default) -->
    <div id="controls-overlay" class="controls-overlay hidden">
      <div class="controls-content">
        <h2>Controls</h2>
        <div class="control-group">
          <strong>Mouse:</strong>
          <ul>
            <li>Left-click and drag to pan</li>
            <li>Double-click to zoom in</li>
            <li>Mouse wheel to zoom in/out</li>
            <li>Right-click for context menu (save location, view Julia set)</li>
          </ul>
        </div>
        <div class="control-group">
          <strong>Touch:</strong>
          <ul>
            <li>Pinch to zoom</li>
            <li>Double-tap to zoom in</li>
            <li>Drag to pan</li>
            <li>Long tap for context menu</li>
          </ul>
        </div>
        <div class="control-group">
          <strong>Keyboard:</strong>
          <ul>
            <li>Arrow keys or WASD to pan</li>
            <li>+ / - to zoom in/out</li>
            <li>R to reset view</li>
            <li>Escape to return to title screen</li>
          </ul>
        </div>
        <button id="close-controls-btn" class="close-button">Close</button>
      </div>
    </div>

    <!-- Implementation Documentation Overlay -->
    <div id="implementation-overlay" class="controls-overlay hidden">
      <div class="controls-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto; padding: 30px;">
        <h2 style="margin-top: 0; margin-bottom: 25px;">Deep Zoom Implementation</h2>
        
        <h3 style="margin-top: 30px; margin-bottom: 15px;">Two Rendering Methods</h3>
        <p style="margin-bottom: 15px;">This application uses two different rendering techniques depending on the zoom depth:</p>

        <h3 style="margin-top: 30px; margin-bottom: 15px;">Standard Method (Zoom < 10<sup>-7</sup>)</h3>
        <p style="margin-bottom: 15px;">At shallow zoom levels, we use the direct iteration method where each pixel independently calculates:</p>
        <p style="text-align: center; font-size: 1.3em; margin: 20px 0; font-family: 'Times New Roman', serif;">
          z<sub>n+1</sub> = z<sub>n</sub><sup>2</sup> + c
        </p>
        <p style="margin-bottom: 20px;">This is computed using 32-bit floating-point numbers on the GPU, which is fast and provides good precision down to about 10<sup>-7</sup> zoom depth. Beyond this, numerical precision limits prevent further accurate zooming.</p>

        <h3 style="margin-top: 30px; margin-bottom: 15px;">Perturbation Method (Zoom ‚â• 10<sup>-7</sup>)</h3>
        <p style="margin-bottom: 15px;">At extreme zoom depths (10<sup>-7</sup> to 10<sup>-38</sup>), we switch to a more sophisticated approach:</p>
        <ol style="line-height: 2.2; margin-bottom: 15px; padding-left: 25px;">
          <li><strong>Reference orbit calculation:</strong> A single high-precision orbit is calculated on the CPU using arbitrary-precision arithmetic (Decimal.js). This gives us the "true" orbit path for one point.</li>
          <li><strong>Delta calculations:</strong> For every other pixel, we calculate small <em>differences</em> (deltas) from this reference orbit using GPU 32-bit floats. Since these differences are small, 32-bit precision is sufficient.</li>
          <li><strong>Orbit composition:</strong> The final orbit for each pixel is: orbit = reference_orbit + delta</li>
        </ol>
        <p style="margin-bottom: 20px;">This technique, known as <em>perturbation theory</em>, allows us to reach zoom depths of 10<sup>-38</sup> on desktop while maintaining full visual detail and smooth performance.</p>

        <h3 style="margin-top: 30px; margin-bottom: 15px;">Understanding Orbits</h3>
        <p style="margin-bottom: 15px;">An <em>orbit</em> is the sequence of points generated by repeatedly applying the Mandelbrot formula:</p>
        <p style="text-align: center; margin: 15px 0;">z<sub>0</sub> ‚Üí z<sub>1</sub> ‚Üí z<sub>2</sub> ‚Üí z<sub>3</sub> ‚Üí ...</p>
        <p style="margin-bottom: 20px;">When pixels are close together (at deep zoom), their orbits follow very similar paths. The perturbation method exploits this similarity by only calculating one precise orbit, then using deltas to approximate nearby orbits efficiently.</p>

        <h3 style="margin-top: 30px; margin-bottom: 15px;">Orbit Quality</h3>
        <p style="margin-bottom: 15px;">The <strong>orbit quality</strong> indicator shows how well the perturbation approximation is working. It measures how close the delta orbits remain to the reference orbit:</p>
        <ul style="line-height: 2.2; margin-bottom: 15px;">
          <li><strong>100%:</strong> Perfect accuracy, all pixels use valid perturbation calculations</li>
          <li><strong>90-99%:</strong> Very good, minor deviations at image edges</li>
          <li><strong>Below 90%:</strong> Some pixels may show artifacts or pixelation</li>
        </ul>
        <p style="margin-bottom: 20px;">When orbit quality drops, panning or zooming slightly will recalculate a new reference orbit and restore quality. Areas near black (in-set) regions typically have better orbit quality than boundary areas.</p>

        <h3 style="margin-top: 30px; margin-bottom: 15px;">Automatic Iteration Optimisation</h3>
        <p style="margin-bottom: 15px;">The <strong>max iterations</strong> setting controls how many times we iterate the formula before giving up. Higher values reveal more detail but require more computation. In <strong>Auto mode</strong> (recommended), the app uses two different strategies:</p>
        <ul style="line-height: 2.2; margin-bottom: 15px;">
          <li><strong>Shallow zoom (&gt;10<sup>-7</sup>):</strong> Iterations scale linearly with zoom depth (deeper = more iterations)</li>
          <li><strong>Deep zoom (‚â§10<sup>-7</sup>):</strong> Intelligent optimisation searches for the iteration count that achieves 92-99.5% orbit quality</li>
        </ul>
        <p style="margin-bottom: 15px;">The deep zoom optimiser uses a four-phase search algorithm:</p>
        <ol style="line-height: 2.2; margin-bottom: 15px; padding-left: 25px;">
          <li><strong>Phase 1 - Coarse search:</strong> Tests 40 samples across a wide range (20%-300% of current value)</li>
          <li><strong>Phase 2 - Fine search:</strong> Narrows in around the best result with smaller steps</li>
          <li><strong>Phase 3 - Ultra-fine search:</strong> Final refinement when quality is 95-99%</li>
          <li><strong>Phase 4 - Stability test:</strong> Tests ¬±1 iteration for optimal stability when quality is 98%+</li>
        </ol>
        <p style="margin-bottom: 15px;">Watch for the red <strong>"‚è≥ Optimising"</strong> indicator when this is running. It appears automatically when orbit quality drops below 95%. The optimiser runs asynchronously so you can continue panning and zooming.</p>
        <p style="margin-bottom: 15px;"><strong>Manual mode</strong> lets you override the optimiser and set iterations yourself:</p>
        <ul style="line-height: 2.2; margin-bottom: 15px;">
          <li><strong>Mobile:</strong> Slider range 50-4,000 iterations</li>
          <li><strong>Desktop:</strong> Slider range 50-20,000 iterations</li>
        </ul>
        <p style="margin-bottom: 20px;">Black areas (points inside the set) always use the maximum iterations, while coloured areas (points that escape) typically use fewer iterations. This is why panning through black regions is more GPU-intensive.</p>

        <h3 style="margin-top: 30px; margin-bottom: 15px;">Platform Differences</h3>
        <p style="margin-bottom: 15px;">Desktop and mobile devices have different capabilities:</p>
        <ul style="line-height: 2.2; margin-bottom: 20px;">
          <li><strong>Desktop:</strong> Can reach 10<sup>-38</sup> zoom depth with aggressive iteration scaling. Includes coordinate display with arbitrary precision.</li>
          <li><strong>Mobile:</strong> Limited to ~10<sup>-20</sup> zoom depth with conservative iteration scaling to maintain smooth, responsive performance. Some features like coordinate display are disabled for performance.</li>
        </ul>

        <button id="close-implementation-btn" class="close-button" style="margin-top: 25px;">Close</button>
      </div>
    </div>

    <main>
      <!-- WebGL canvas for GPU rendering -->
      <div id="canvas-wrap">
        <canvas id="canvas-gl" class="canvas-layer"></canvas>
        <div id="zoom-info">
          <div>Zoom: <span id="zoom-level">1√ó</span></div>
          <div>Scale: <span id="scale-value">0</span></div>
        </div>
        <div id="orbit-quality-info" class="hidden">
          <div><span>Orbit Quality:</span> <span id="orbit-quality-value">100%</span></div>
        </div>
        <div id="optimization-status" class="hidden">
          <div><span>‚è≥</span> <span>Optimising</span></div>
        </div>
        <div id="julia-set-button-wrap" class="hidden">
          <button id="show-julia-btn" class="julia-set-btn">View This Julia Set</button>
        </div>
        <div id="julia-info" class="hidden">
          <button id="back-to-mandelbrot" class="back-btn-inline">Back to Mandelbrot</button>
        </div>
        
        <!-- Context Menu -->
        <div id="context-menu" class="context-menu hidden">
          <div class="context-menu-item" id="menu-show-julia">View This Julia Set</div>
          <div class="context-menu-item" id="menu-save-location">Save Location...</div>
          <div class="context-menu-item" id="menu-save-julia">Save Julia Set...</div>
          <div class="context-menu-item" id="menu-share-location">Share Location</div>
        </div>

        <!-- Save Location Modal -->
        <div id="save-location-modal" class="modal hidden">
          <div class="modal-content">
            <h3>Save Location</h3>
            <input type="text" id="location-name-input" placeholder="Enter location name..." maxlength="30">
            <div class="modal-buttons">
              <button id="save-location-btn" class="modal-btn">Save</button>
              <button id="cancel-location-btn" class="modal-btn cancel">Cancel</button>
            </div>
          </div>
        </div>

        <!-- Manage Locations Modal -->
        <div id="manage-locations-modal" class="modal hidden">
          <div class="modal-content manage-modal">
            <h3>Manage My Locations</h3>
            <div id="manage-locations-list"></div>
            <div class="modal-buttons">
              <button id="close-manage-btn" class="modal-btn">Close</button>
            </div>
          </div>
        </div>

        <!-- Save Julia Set Modal -->
        <div id="save-julia-modal" class="modal hidden">
          <div class="modal-content">
            <h3>Save Julia Set</h3>
            <input type="text" id="julia-name-input" placeholder="Enter Julia set name..." maxlength="30">
            <div class="modal-buttons">
              <button id="save-julia-btn" class="modal-btn">Save</button>
              <button id="cancel-julia-btn" class="modal-btn cancel">Cancel</button>
            </div>
          </div>
        </div>

        <!-- Manage Julia Sets Modal -->
        <div id="manage-julia-modal" class="modal hidden">
          <div class="modal-content manage-modal">
            <h3>Manage My Julia Sets</h3>
            <div id="manage-julia-list"></div>
            <div class="modal-buttons">
              <button id="close-manage-julia-btn" class="modal-btn">Close</button>
            </div>
          </div>
        </div>

        <!-- Deep Zoom Warning Modal -->
        <div id="deep-zoom-modal" class="modal hidden">
          <div class="modal-content deep-zoom-info">
            <h3>Entering Deep Zoom Territory!</h3>
            <p>You've crossed the <strong>10<sup>-7</sup> barrier</strong> where normal floating-point precision runs out of steam. The app now uses <strong>perturbation theory</strong> to reach extreme depths! üöÄ</p>
            
            <h4>üéØ Best Navigation Strategy</h4>
            <p><strong>For the most stunning images with minimal artifacts:</strong></p>
            <ul>
              <li><strong>Zoom on BLACK areas that are close to colourful regions</strong></li>
              <li>Black = inside the set = stable orbits = best quality (95-100%)</li>
              <li>Position near colour = fractal detail nearby = visual interest</li>
              <li>This gives you both stability <em>and</em> beauty! ‚ú®</li>
              <li><strong>Pro tip:</strong> Use double-click/double-tap to zoom instead of mouse wheel/pinch - makes it easier to zoom precisely on a black spot near colour</li>
            </ul>
            
            <h4>‚è≥ Automatic Optimisation</h4>
            <p>The app automatically finds the best iteration count for image quality. Watch for the red <strong>"‚è≥ Optimising"</strong> indicator (bottom right).</p>
            <ul>
              <li><strong>Usually:</strong> Just wait - it'll find the sweet spot!</li>
              <li><strong>If needed:</strong> Use the <strong>Max Iterations slider</strong> to fine-tune manually, or try tiny panning with arrow keys to find a better reference point</li>
              <li><strong>Orbit Quality</strong> shows how well it's working: üü¢ Green (90-100%) = Excellent</li>
            </ul>
            
            <h4>What's Possible?</h4>
            <p>You can reach zoom depths of <strong>10<sup>-38</sup></strong> viewing details <strong>trillions of times smaller than atoms</strong> compared to your starting view! ü§Ø</p>
            
            <div class="modal-buttons">
              <button id="deep-zoom-ok-btn" class="modal-btn">Got It - Let's Go Deep! üöÄ</button>
            </div>
          </div>
        </div>
      </div>
    </main>

  </div>

  <!-- Decimal.js for arbitrary precision (deep zoom) -->
  <script src="https://cdn.jsdelivr.net/npm/decimal.js@10.4.3/decimal.min.js"></script>
  <script src="app.js"></script>
</body>
</html>